# نظام إعادة تعيين كلمة المرور

## الملفات المضافة

### الواجهة الأمامية (Frontend)
- `frontend/src/components/Auth/ForgotPassword.js` - صفحة طلب إعادة تعيين كلمة المرور
- `frontend/src/components/Auth/ForgotPassword.css` - تصميم صفحة طلب إعادة التعيين
- `frontend/src/components/Auth/ResetPassword.js` - صفحة إعادة تعيين كلمة المرور
- `frontend/src/components/Auth/ResetPassword.css` - تصميم صفحة إعادة التعيين

### الخادم (Backend)
- تم تحديث `backend/server.js` لإضافة الراوتات التالية:
  - `POST /api/forgot-password` - طلب إعادة تعيين كلمة المرور
  - `GET /api/reset-password/verify/:token` - التحقق من صحة التوكن
  - `POST /api/reset-password` - إعادة تعيين كلمة المرور
- تم تحديث `backend/models/User.js` لإضافة حقول التوكن

## المتطلبات

### متغيرات البيئة المطلوبة
يجب إضافة المتغيرات التالية في ملف `.env`:

```env
# SendGrid API Key لإرسال البريد الإلكتروني
SENDGRID_API_KEY=your_sendgrid_api_key_here

# عنوان البريد الإلكتروني المرسل
EMAIL_SENDER=your_email@example.com

# اسم المرسل
MAIL_SENDER_NAME=اسم التطبيق

# JWT Secret
JWT_SECRET=your_jwt_secret_here

# MongoDB URI
MONGODB_URI=your_mongodb_connection_string
```

### تثبيت المكتبات المطلوبة
```bash
# في مجلد backend
npm install @sendgrid/mail crypto
```

## كيفية الاستخدام

### 1. طلب إعادة تعيين كلمة المرور
1. انتقل إلى صفحة تسجيل الدخول
2. انقر على "نسيت كلمة المرور؟"
3. أدخل بريدك الإلكتروني
4. سيتم إرسال رابط إعادة التعيين إلى بريدك الإلكتروني

### 2. إعادة تعيين كلمة المرور
1. انقر على الرابط المرسل في البريد الإلكتروني
2. أدخل كلمة المرور الجديدة
3. أكد كلمة المرور
4. انقر على "إعادة تعيين كلمة المرور"

## الميزات

### الأمان
- التوكن صالح لمدة ساعة واحدة فقط
- التوكن يتم حذفه بعد الاستخدام
- كلمة المرور يتم تشفيرها باستخدام bcrypt
- التحقق من صحة التوكن قبل إعادة التعيين

### تجربة المستخدم
- تصميم متجاوب يعمل على جميع الأجهزة
- رسائل خطأ واضحة باللغة العربية
- مؤشرات تحميل أثناء العمليات
- توجيه تلقائي لصفحة تسجيل الدخول بعد النجاح

### البريد الإلكتروني
- تصميم جميل ومتجاوب للبريد الإلكتروني
- رابط مباشر لإعادة التعيين
- رابط احتياطي في حالة عدم عمل الرابط المباشر
- معلومات واضحة حول صلاحية الرابط

## إعداد SendGrid

1. إنشاء حساب في [SendGrid](https://sendgrid.com/)
2. إنشاء API Key
3. إضافة عنوان البريد الإلكتروني المرسل
4. إضافة المتغيرات في ملف `.env`

## استكشاف الأخطاء

### مشاكل شائعة
1. **البريد الإلكتروني لا يصل**: تحقق من إعدادات SendGrid و API Key
2. **الرابط لا يعمل**: تأكد من أن التوكن صالح ولم ينتهي
3. **خطأ في قاعدة البيانات**: تحقق من اتصال MongoDB

### سجلات الأخطاء
يتم تسجيل جميع الأخطاء في console الخادم لتسهيل استكشاف الأخطاء.

## ملاحظات مهمة

- تأكد من تحديث عنوان URL في `resetUrl` عند النشر على الخادم الإنتاجي
- قم بتغيير `JWT_SECRET` إلى قيمة آمنة وعشوائية
- احتفظ بمفاتيح API في مكان آمن ولا تشاركها
- اختبر النظام في بيئة التطوير قبل النشر 